{% extends 'base.html' %}

{% block title %}{{ site_config.site_name }} - Home{% endblock %}

{% block content %}
<div class="homepage">
    <div class="hero-section">
        <h1>Welcome to {{ site_config.site_name }}</h1>
        <p>{{ site_config.site_description|default:"Discover and share amazing mods for your favorite games!" }}</p>
        {% if not user.is_authenticated %}
            <div class="hero-actions">
                <a href="{% url 'account_signup' %}" class="btn btn-primary">Join Now</a>
                <a href="{% url 'core:featured' %}" class="btn btn-secondary">Browse Mods</a>
            </div>
        {% endif %}
    </div>

    <div class="recent-mods-section">
        <h2>Recent Mods</h2>
        
        {% if recent_mods %}
            <div class="mods-grid">
                {% for mod in recent_mods %}
                    <div class="mod-card">
                        <div class="mod-images">
                            {% if mod.images.first %}
                                <img src="{{ mod.images.first.image.url }}" alt="{{ mod.name }}" class="mod-main-image">
                                {% if mod.images.count > 1 %}
                                    <div class="mod-thumbnails">
                                        {% for image in mod.images.all|slice:":4" %}
                                            <img src="{{ image.image.url }}" alt="{{ mod.name }}" class="mod-thumbnail" onclick="swapImage(this, '{{ image.image.url }}')">
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            {% else %}
                                <div class="mod-placeholder">No Image</div>
                            {% endif %}
                        </div>
                        
                        <div class="mod-info">
                            <h3><a href="{{ mod.get_absolute_url }}">{{ mod.name }}</a></h3>
                            <p class="mod-author">by <a href="{% url 'accounts:profile' mod.main_author.username %}">{{ mod.main_author.username }}</a></p>
                            <p class="mod-game">{{ mod.game.name }}</p>
                            <p class="mod-date">{{ mod.created_at|date:"M d, Y" }}</p>
                        </div>
                    </div>
                {% endfor %}
            </div>
            
            <div class="view-more">
                <a href="{% url 'core:featured' %}" class="btn btn-outline">View All Mods</a>
            </div>
        {% else %}
            <div class="no-mods">
                <p>No mods available yet. Be the first to upload one!</p>
                {% if user.is_authenticated %}
                    <a href="{% url 'mods:upload' %}" class="btn btn-primary">Upload Mod</a>
                {% endif %}
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function swapImage(thumbnail, newSrc) {
    const mainImage = thumbnail.closest('.mod-card').querySelector('.mod-main-image');
    const oldSrc = mainImage.src;
    mainImage.src = newSrc;
    thumbnail.src = oldSrc;
}
</script>
{% endblock %}